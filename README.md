# BuildServer

## Запуск

1. Скачать этот репозиторий

2. Чтобы запустить CI сервер:
   - `cd server`
   - Добавить `.env` файл в корень папки с единственной строкой
   ```JS
   authToken="uuiiayuer"
   ```
   Где "uuiiayuer" - токен авторизации(без "Bearer") для [бекенда Яндекса](https://shri.yandex/hw/api/index.html)
   - `npm ci && npm start`

3. Чтобы запустить агента:
   - `cd agent && npm ci`
   - `docker build -t <yourName>/node:14 .`
   - `docker run -e PORT=<yourPort> -p <yourPort>:1000 <yourName>/node:14`

## CI сервер

Сервер запускается на том хосте и порте, который указан в конфигурации.

Однако функционал обновления настроек и добавления билдов в очередь строится на том,
что [node api](https://github.com/Super-Cereal/CiServer) делает запросы к этому серверу.

Поэтому при необходимости изменить хост и порт, их необходимо менять и в файле конфигурации [node api](https://github.com/Super-Cereal/CiServer)

Чем раньше билд был добавлен в очередь, тем раньше он начнет свое исполнение

## Агенты

Агент запускается на хосте и порту, которые указаны в файле конфигурации. А доступен он будет на порту, который будет указан при постройке докер контейнера
